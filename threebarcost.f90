!================================== Objective functions

subroutine threebarf(fctindx,dat,x,f)
  implicit none

  integer,intent(in) ::fctindx
  real*8,intent(in)  ::dat(20)
  real*8,intent(in)  ::x(6)
  real*8::E,H,gamma,theta,P,phi(3),L(3),Pu,Pv,tensile_sigma1_max,tensile_sigma2_max,tensile_sigma3_max,comp_sigma1_max,comp_sigma2_max,comp_sigma3_max,max_u_disp,max_v_disp,Fs,sigma(3),u,v

  real*8,intent(out)::f

  ! Read/store needed params

  H=dat(1)
  E=dat(2)
  gamma=dat(3)
  theta=dat(4)
  P=dat(5)

  tensile_sigma1_max=dat(6)      
  tensile_sigma2_max=dat(7)
  tensile_sigma3_max=dat(8)

  comp_sigma1_max=dat(9)      
  comp_sigma2_max=dat(10)
  comp_sigma3_max=dat(11)

  max_u_disp=dat(12)
  max_v_disp=dat(13)

  Fs=dat(14)

  phi(1)=x(4)
  phi(2)=x(5)
  phi(3)=x(6)

  L(1)=H/sin(phi(1))
  L(2)=H/sin(phi(2))
  L(3)=H/sin(phi(3))


  pu=P*cos(theta)
  pv=P*sin(theta)


  !  if(fctindx.gt.0) then

  !     if (fctindx.le.6) then ! evaluate stresses alone

  sigma(1)=(E*sin(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1)

  sigma(2)=(E*sin(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2)

  sigma(3)=(E*sin(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3)



  sigma(:)=sigma(:)*Fs
  !     else ! evaluate u and v

  u= (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))

  v= (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))

  u=u*Fs
  v=v*Fs

  !     end if

  !  end if


!!$
!!$  print*,''
!!$  print*,'u      :',u
!!$  print*,'v      :',v
!!$  print*,'sigma1 :',sigma(1)
!!$  print*,'sigma2 :',sigma(2)
!!$  print*,'sigma3 :',sigma(3)
!!$  print*,''



  f=0.0 ! initialize

  if (fctindx.eq.0) then
     F= x(1)*gamma*L(1) + x(2)*gamma*L(2) +  x(3)*gamma*L(3)
  else if (fctindx.eq.1) then
     F = (sigma(1) - tensile_sigma1_max)/tensile_sigma1_max   !tensile 1
  else if (fctindx.eq.2) then
     F = (sigma(2) - tensile_sigma2_max)/tensile_sigma2_max   !tensile 2
  else if (fctindx.eq.3) then 
     F = (sigma(3) - tensile_sigma3_max)/tensile_sigma3_max   !tensile 3
  else if (fctindx.eq.4) then
     F = (-1.0*sigma(1)/comp_sigma1_max) -1.0                 !compressive 1
  else if (fctindx.eq.5) then
     F = (-1.0*sigma(2)/comp_sigma2_max) -1.0                 !compressive 2
  else if (fctindx.eq.6) then
     F = (-1.0*sigma(3) / comp_sigma3_max) -1.0               !compressive 3
  else if (fctindx.eq.7) then
     F = (u -max_u_disp)/max_u_disp
  else if (fctindx.eq.8) then
     F = (v -max_v_disp)/max_v_disp
  else
     stop'Wrong Fctindx for 6d threebar'
  end if

  return
end subroutine threebarf

!===================================== Gradients


subroutine threebardf(fctindx,dat,x,df)
  implicit none

  integer,intent(in) ::fctindx
  real*8,intent(in) ::dat(20)
  real*8,intent(in)  ::x(6)
  real*8,intent(out)::df(6)
  real*8::E,H,gamma,theta,P,phi(3),L(3),Pu,Pv,tensile_sigma1_max,tensile_sigma2_max,tensile_sigma3_max,comp_sigma1_max,comp_sigma2_max,comp_sigma3_max,max_u_disp,max_v_disp,Fs,sigma(3),u,v

  ! Read/store needed params

  H=dat(1)
  E=dat(2)
  gamma=dat(3)
  theta=dat(4)
  P=dat(5)

  tensile_sigma1_max=dat(6)      
  tensile_sigma2_max=dat(7)
  tensile_sigma3_max=dat(8)

  comp_sigma1_max=dat(9)      
  comp_sigma2_max=dat(10)
  comp_sigma3_max=dat(11)

  max_u_disp=dat(12)
  max_v_disp=dat(13)

  Fs=dat(14)

  phi(1)=x(4)
  phi(2)=x(5)
  phi(3)=x(6)

  L(1)=H/sin(phi(1))
  L(2)=H/sin(phi(2))
  L(3)=H/sin(phi(3))

  pu=P*cos(theta)
  pv=P*sin(theta)

  df=0.0 !initialize 

  if (fctindx.eq.0) then


     df(1)=(H*gamma)/sin(phi(1))

     df(2)=(H*gamma)/sin(phi(2))

     df(3)=(H*gamma)/sin(phi(3))

     df(4)=-(X(1)*H*gamma*cos(phi(1)))/sin(phi(1))**2.0

     df(5)=-(X(2)*H*gamma*cos(phi(2)))/sin(phi(2))**2.0

     df(6)=-(X(3)*H*gamma*cos(phi(3)))/sin(phi(3))**2.0


  else if (fctindx.eq.1) then
     df(1)=-((E*sin(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pu*cos(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 &
          &+ X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pv*sin(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/tensile_sigma1_max

     df(2)=-((E*sin(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pu*cos(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pv*sin(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/tensile_sigma1_max

     df(3)=-((E*sin(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pu*cos(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pv*sin(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/tensile_sigma1_max

     df(4)=-((E*sin(phi(1))*((Pv*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(1)*L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) - (E*cos(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) &
          &- 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(1)*L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*sin(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/tensile_sigma1_max

     df(5)=-((E*sin(phi(1))*((Pv*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) &
          &- 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(2)*L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pu*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(2)*L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/tensile_sigma1_max

     df(6)=-((E*sin(phi(1))*((Pv*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(3)*L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pu*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(3)*L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/tensile_sigma1_max



  else if (fctindx.eq.2) then

     df(1)=-((E*sin(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pu*cos(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0&
          & + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pv*sin(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/tensile_sigma2_max

     df(2)=-((E*sin(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pu*cos(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0&
          & + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pv*sin(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/tensile_sigma2_max

     df(3)=-((E*sin(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pu*cos(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) &
          &- 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pv*sin(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/tensile_sigma2_max

     df(4)=-((E*sin(phi(2))*((Pv*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3))&
          & - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(1)*L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(1)*L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/tensile_sigma2_max

     df(5)=-((E*sin(phi(2))*((Pv*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(2)*L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) - (E*cos(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) &
          &- 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pu*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(2)*L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*sin(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/tensile_sigma2_max

     df(6)=-((E*sin(phi(2))*((Pv*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(3)*L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pu*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(3)*L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/tensile_sigma2_max


  else if (fctindx.eq.3) then


     df(1)=-((E*sin(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pu*cos(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) &
          &- 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pv*sin(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/tensile_sigma3_max

     df(2)=-((E*sin(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pu*cos(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pv*sin(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/tensile_sigma3_max

     df(3)=-((E*sin(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pu*cos(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) &
          &- 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pv*sin(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/tensile_sigma3_max

     df(4)=-((E*sin(phi(3))*((Pv*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(1)*L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(1)*L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/tensile_sigma3_max

     df(5)=-((E*sin(phi(3))*((Pv*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(2)*L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pu*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(2)*L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/tensile_sigma3_max

     df(6)=-((E*sin(phi(3))*((Pv*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(3)*L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) - (E*cos(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) &
          &- 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pu*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(3)*L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*sin(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/tensile_sigma3_max


  else if (fctindx.eq.4) then

     df(1)=((E*sin(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pu*cos(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pv*sin(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/comp_sigma1_max

     df(2)=((E*sin(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pu*cos(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))&
          & - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pv*sin(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/comp_sigma1_max

     df(3)=((E*sin(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pu*cos(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) &
          &- 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pv*sin(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/comp_sigma1_max

     df(4)=((E*sin(phi(1))*((Pv*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(1)*L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) - (E*cos(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(1)*L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*sin(phi(1))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/comp_sigma1_max

     df(5)=((E*sin(phi(1))*((Pv*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(2)*L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0&
          & + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pu*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(2)*L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/comp_sigma1_max

     df(6)=((E*sin(phi(1))*((Pv*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) &
          &- 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(3)*L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1) + (E*cos(phi(1))*((Pu*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(3)*L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(1))/comp_sigma1_max



  else if (fctindx.eq.5) then

     df(1)=((E*sin(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pu*cos(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0&
          & + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pv*sin(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/comp_sigma2_max

     df(2)=((E*sin(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pu*cos(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0&
          & - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pv*sin(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/comp_sigma2_max

     df(3)=((E*sin(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pu*cos(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pv*sin(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/comp_sigma2_max

     df(4)=((E*sin(phi(2))*((Pv*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(1)*L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(1)*L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/comp_sigma2_max

     df(5)=((E*sin(phi(2))*((Pv*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(2)*L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) - (E*cos(phi(2))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) +&
          & X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pu*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(2)*L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*sin(phi(2))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/comp_sigma2_max

     df(6)=((E*sin(phi(2))*((Pv*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(3)*L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))&
          & - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2) + (E*cos(phi(2))*((Pu*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(3)*L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(2))/comp_sigma2_max


  else if (fctindx.eq.6) then


     df(1)=((E*sin(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pu*cos(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(2)*L(3)*Pv*sin(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/comp_sigma3_max

     df(2)=((E*sin(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pu*cos(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(3)*Pv*sin(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/comp_sigma3_max

     df(3)=((E*sin(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pu*cos(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (L(1)*L(2)*Pv*sin(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/comp_sigma3_max

     df(4)=((E*sin(phi(3))*((Pv*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(1)*L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(1)*L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/comp_sigma3_max

     df(5)=((E*sin(phi(3))*((Pv*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2))&
          & - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(2)*L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*cos(phi(3))*((Pu*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(2)*L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/comp_sigma3_max

     df(6)=((E*sin(phi(3))*((Pv*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 + (2.0*X(3)*L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) - (E*cos(phi(3))*((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) +&
          & (E*cos(phi(3))*((Pu*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))**2.0 - (2.0*X(3)*L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3) + (E*sin(phi(3))*((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)))))/L(3))/comp_sigma3_max

  else if (fctindx.eq.7) then


     df(1)=((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (L(2)*L(3)*Pu*cos(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_u_disp

     df(2)=((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (L(1)*L(3)*Pu*cos(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_u_disp

     df(3)=((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (L(1)*L(2)*Pu*cos(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_u_disp

     df(4)=((Pv*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 + (2.0*X(1)*L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_u_disp

     df(5)=((Pv*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 + (2.0*X(2)*L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_u_disp

     df(6)=((Pv*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pv*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 + X(2)*L(1)*L(3)*cos(phi(2))**2.0 + X(3)*L(1)*L(2)*cos(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 + (2.0*X(3)*L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_u_disp


     df(:)=-df(:) ! to correct the change in coordinate system/meaningful constaint


  else if (fctindx.eq.8) then
     df(1)=-((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 - 2.0*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (L(2)*L(3)*Pv*sin(phi(1))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(2)*L(3)*Pu*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_v_disp

     df(2)=-((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (L(1)*L(3)*Pv*sin(phi(2))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(3)*Pu*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_v_disp

     df(3)=-((Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(X(1)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (L(1)*L(2)*Pv*sin(phi(3))**2.0)/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (L(1)*L(2)*Pu*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_v_disp

     df(4)=-((Pu*(X(1)*L(2)*L(3)*cos(phi(1))**2.0 - X(1)*L(2)*L(3)*sin(phi(1))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) - (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 + (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) + 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (2.0*X(1)*L(2)*L(3)*Pv*cos(phi(1))*sin(phi(1)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_v_disp

     df(5)=-((Pu*(X(2)*L(1)*L(3)*cos(phi(2))**2.0 - X(2)*L(1)*L(3)*sin(phi(2))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))**2.0*sin(phi(1)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*cos(phi(2))*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*sin(phi(1))*sin(phi(2))**2.0 + 2.0*X(1)*X(2)*E*L(3)*cos(phi(2))*sin(phi(1))**2.0*sin(phi(2)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (2.0*X(2)*L(1)*L(3)*Pv*cos(phi(2))*sin(phi(2)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_v_disp

     df(6)=-((Pu*(X(3)*L(1)*L(2)*cos(phi(3))**2.0 - X(3)*L(1)*L(2)*sin(phi(3))**2.0))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))) + (Pu*(X(1)*L(2)*L(3)*cos(phi(1))*sin(phi(1)) + X(2)*L(1)*L(3)*cos(phi(2))*sin(phi(2)) + X(3)*L(1)*L(2)*cos(phi(3))*sin(phi(3)))*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (Pv*(X(1)*L(2)*L(3)*sin(phi(1))**2.0 + X(2)*L(1)*L(3)*sin(phi(2))**2.0 + X(3)*L(1)*L(2)*sin(phi(3))**2.0)*(2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))**2.0*sin(phi(1)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*cos(phi(3))*sin(phi(3)) + 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))**2.0*sin(phi(2)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*cos(phi(3))*sin(phi(3)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*sin(phi(1))*sin(phi(3))**2.0 + 2.0*X(1)*X(3)*E*L(2)*cos(phi(3))*sin(phi(1))**2.0*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*sin(phi(2))*sin(phi(3))**2.0 + 2.0*X(2)*X(3)*E*L(1)*cos(phi(3))*sin(phi(2))**2.0*sin(phi(3))))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3)) + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0)**2.0 - (2.0*X(3)*L(1)*L(2)*Pv*cos(phi(3))*sin(phi(3)))/(X(1)*X(2)*E*L(3)*cos(phi(1))**2.0*sin(phi(2))**2.0 + X(1)*X(2)*E*L(3)*cos(phi(2))**2.0*sin(phi(1))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(1))**2.0*sin(phi(3))**2.0 + X(1)*X(3)*E*L(2)*cos(phi(3))**2.0*sin(phi(1))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(2))**2.0*sin(phi(3))**2.0 + X(2)*X(3)*E*L(1)*cos(phi(3))**2.0*sin(phi(2))**2.0 - 2.0*X(1)*X(2)*E*L(3)*cos(phi(1))*cos(phi(2))*sin(phi(1))*sin(phi(2)) - 2.0*X(1)*X(3)*E*L(2)*cos(phi(1))*cos(phi(3))*sin(phi(1))*sin(phi(3)) - 2.0*X(2)*X(3)*E*L(1)*cos(phi(2))*cos(phi(3))*sin(phi(2))*sin(phi(3))))/max_v_disp

  else

     stop'Wrong Fctindx for threebar 6d'

  end if

  df(:)=df(:)*Fs ! Factor of safety

  return
end subroutine threebardf

!===================================== Hessian

!!$
!!$subroutine threebard2f()
!!$  implicit none
!!$
!!$! Just kidding
!!$end subroutine threebard2f

